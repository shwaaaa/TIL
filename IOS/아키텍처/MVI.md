# MVI

- `swiftUI`에서 `MVVM`을 사용하다보면
> 1. ViewModel 에서 너무 많은 일을 하고 있다
> 2. Data 의 흐름이 관리가 되지 않는다.

***

## MVI란?
그렇다면 `MVI`란?

- `Model-View-Intent`의 약자로 단방향 아키텍처 패턴이다

![image](https://i0.wp.com/post.dooray.io/wp-content/uploads/2023/08/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7-2023-08-31-%EC%98%A4%ED%9B%84-5.48.55.png?resize=2048%2C1071&ssl=1)

- Model(state) : 앱의 상태를 의미하며 `MVI`에서는 하나의 상태만을 가지며 `immutable`한 데이터 구조로 작성 되어야 한다. `intent`를 트리거 하여 새로운 상태를 만드는 것만이 `State`를 바꾸는 유일한 방법.
> - immutable이란? 데이터나 객체를 변경할 수 없는 상태

- View : 사용자에게 제공되어 보여 지는 `UI` 부분으로 `상태(state)`를 입력 받아 화면에 출력

- Intent : 앱 상태를 변경 하려는 의도를 의미하며 사용자의 상호작용으로 발생한 상태를 변경 하는 동작을 한다.

## 이벤트 흐름

1. 유저의 인터렉션이 발생(화면 터치 등의 동작)
2. `Intent`로 해당 `Event`가 전달
3. `Intent가` 상황에 맞는 `Model(State)`을 업데이트
4. `View`에서는 `Model(State)`을 관찰하고 있다가 변화가 일어 날 때 마다 이를 감지하여 상태에 맞는 화면을 렌더링 한다.

- `View`에서는 `Model(State)`를 직접적으로 수정 할 방법은 존재 하지 않음을 의미하며 `Model(State)`을 수정하기 위해서는 `Intent`를 거쳐야만 한다. 

- 또한 `Intent`에 서는 `View`에 대한 정보를 갖고 있지 않으며 `Intent`에서 `View`로 `Event`를 전달 할 수 없다.

***

## 장단점

장점
- 앱의 상태가 하나 뿐이라, 상호작용이 많아져도 상태 충돌이 없다.
- 데이터의 흐름이 정해져 있어 흐름을 이해하고 관리하기가 쉽다.
- 각각 값이 불변하기 때문에, 스레드에 있어 안정성을 갖는다.

단점 
- 작은 변경도 모두 `intent`를 통해야 하고, 아주 작은 앱도 최소한의 `intent`와 `model`을 가져야 한다.
- `model`을 업데이트 하기 위해 매번 새로운 인스턴스를 만들어야 하므로, 너무 많은 객체가 만들어지면 `gc`가 빈번하게 작동될 수 있다.
> - gc : 메모리 관리를 Garbage Collector라는 것이 프로그램 실행중에 동적으로 감시하고 있다가, 더 이상 사용할 필요가 없다고 여겨지는 것(garbage)을 메모리에서 삭제하는 것. 런타임에 메모리 관리.