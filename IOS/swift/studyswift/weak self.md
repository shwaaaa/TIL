# weak self

- `weak self`로는 로 순환 참조를 막을 수 있다

- 그렇다면 순환참조란 뭘까?

## 순환찬조란?
- 순환 참조는 `Strong Reference Cycle`이라고도 하는데, 메모리 문제가 발생하는 원인이다

```swift
var john: Person?
var unit4A: Apartment?

john = Person(name: "John Appleseed")
unit4A = Apartment(unit: "4A")

john!.apartment = unit4A
unit4A!.tenant = john
```
이 코드를 보면 Person 타입의 john과 Apartment 타입의 unit4A 변수를 초기화한 후, 서로를 참조하고 있다


두 변수에 `nil`이 입력되면 서로를 참조하고 있던 것은 그대로 남아있다. 

이게 메모리 누수의 원인이 되는 순환 참조다.

인스턴스는 사라졌지만 참조는 남아있기 때문에 의미 없는 메모리만 남게 되는 것이다.

순환 참조가 쌓이면 앱이 죽거나 메모리 이슈가 발생한다

***

## weak self를 왜 쓰는걸까?

먼저 `weak`에 대해서 알아보자

- `weak`는 프로퍼티나 변수 앞에 적는 키워드로 `약한 참조`를 의미한다.

- `약한 참조`라는 것은 참조하는 인스턴스를 강하게 유지하지 않는 참조로, `ARC`가 참조된 인스턴스를 처리하는 것을 막지 않는다는 걸 말한다.

- 즉, `ARC`가 참조하는 인스턴스가 할당 해제되면 `nil`로 약한 참조를 자동으로 설정한다.
> 여기서 ARC란?
> - 자동 참조 카운팅, 앱의 메모리 사용량을 추적하고 관리하기 위해서 사용되는데, ARC는 인스턴스가 더 이상 필요하지 않을 때(참조 카운팅이 0일 때) 클래스 인스턴스에 의해 자동으로 메모리를 할당 해제한다.

그렇다면 `weak self`란
- 메모리 누수의 원인인 순환 참조를 방지하기 위해서 클로저 블록에 [weak self]를 선언한다